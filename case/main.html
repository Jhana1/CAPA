<html><head><body>
<div class="snippet-container"><div class="sh_bright snippet-wrap"><div class="snippet-menu sh_sourceCode"><a class="snippet-window sh_url" href="#">pop-up</a><a class="snippet-text sh_url" href="#">text</a></div><pre class="shi_pre sh_c snippet-formatted sh_sourceCode" style="display: block;"><ol class="snippet-num"><li><span class="sh_preproc">#include</span> <span class="sh_string">&lt;stdio.h&gt;</span></li><li><span class="sh_preproc">#include</span> <span class="sh_string">&lt;stdlib.h&gt;</span></li><li><span class="sh_preproc">#include</span> <span class="sh_string">&lt;time.h&gt;</span></li><li><span class="sh_preproc">#include</span> <span class="sh_string">&lt;math.h&gt;</span></li><li></li><li class="box box-top" style="margin-left: -3.3em;"><span class="box-sp" style="width: 21px;">&nbsp;</span><span class="sh_type">void</span> <span class="sh_function">reshape2vec</span><span class="sh_symbol">(</span><span class="sh_type">float</span> <span class="sh_symbol">*</span>out_vec<span class="sh_symbol">,</span> <span class="sh_type">float</span> <span class="sh_symbol">*</span>in_mat<span class="sh_symbol">[],</span> <span class="sh_usertype">size_t</span><span class="sh_normal"> </span>dim<span class="sh_symbol">)</span><span class="sh_cbracket">{</span></li><li class="box box-mid" style="margin-left: -3.3em;"><span class="box-sp" style="width: 21px;">&nbsp;</span>    <span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_usertype">size_t</span><span class="sh_normal"> </span>i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> dim<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span></li><li class="box box-mid" style="margin-left: -3.3em;"><span class="box-sp" style="width: 21px;">&nbsp;</span>        <span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_usertype">size_t</span><span class="sh_normal"> </span>j <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> j <span class="sh_symbol">&lt;</span> dim<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>j<span class="sh_symbol">)</span></li><li class="box box-mid" style="margin-left: -3.3em;"><span class="box-sp" style="width: 21px;">&nbsp;</span>            out_vec<span class="sh_symbol">[</span>i<span class="sh_symbol">*</span>dim <span class="sh_symbol">+</span> j<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> in_mat<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">];</span></li><li class="box box-bot" style="margin-left: -3.3em;"><span class="box-sp" style="width: 21px;">&nbsp;</span><span class="sh_cbracket">}</span></li><li></li><li><span class="sh_type">int</span> <span class="sh_function">main</span><span class="sh_symbol">()</span></li><li><span class="sh_cbracket">{</span></li><li></li><li>    <span class="sh_keyword">const</span> <span class="sh_usertype">size_t</span><span class="sh_normal"> </span>ELEMS <span class="sh_symbol">=</span> <span class="sh_number">1000</span><span class="sh_symbol">*</span><span class="sh_number">1000</span><span class="sh_symbol">;</span></li><li>    <span class="sh_type">float</span> starting_vec<span class="sh_symbol">[</span>ELEMS<span class="sh_symbol">];</span></li><li>    <span class="sh_usertype">time_t</span><span class="sh_normal"> </span>t<span class="sh_symbol">;</span></li><li>    </li><li>    <span class="sh_function">srand</span><span class="sh_symbol">((</span><span class="sh_type">unsigned</span><span class="sh_symbol">)</span> <span class="sh_function">time</span><span class="sh_symbol">(&amp;</span>t<span class="sh_symbol">));</span></li><li>    <span class="sh_function">random_fill</span><span class="sh_symbol">(</span>starting_vec<span class="sh_symbol">,</span> ELEMS<span class="sh_symbol">);</span></li><li>    </li><li>    <span class="sh_comment">// Divide all points by 2 and add 4 for later stage</span></li><li class="box box-top" style="margin-left: -3.3em;"><span class="box-sp" style="width: 21px;">&nbsp;</span>    <span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_usertype">size_t</span><span class="sh_normal"> </span>i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> ELEMS<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span><span class="sh_cbracket">{</span></li><li class="box box-mid" style="margin-left: -3.3em;"><span class="box-sp" style="width: 21px;">&nbsp;</span>        starting_vec<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">/=</span> <span class="sh_number">2</span><span class="sh_symbol">;</span></li><li class="box box-mid" style="margin-left: -3.3em;"><span class="box-sp" style="width: 21px;">&nbsp;</span>        starting_vec<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">+=</span> <span class="sh_number">4</span><span class="sh_symbol">;</span></li><li class="box box-bot" style="margin-left: -3.3em;"><span class="box-sp" style="width: 21px;">&nbsp;</span>    <span class="sh_cbracket">}</span></li><li>    </li><li>    <span class="sh_comment">// Calculate mean</span></li><li>    <span class="sh_type">float</span> k <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span></li><li class="box box-top" style="margin-left: -3.3em;"><span class="box-sp" style="width: 21px;">&nbsp;</span>    <span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_usertype">size_t</span><span class="sh_normal"> </span>i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> ELEMS<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span></li><li class="box box-bot" style="margin-left: -3.3em;"><span class="box-sp" style="width: 21px;">&nbsp;</span>        k <span class="sh_symbol">+=</span> starting_vec<span class="sh_symbol">[</span>i<span class="sh_symbol">]/</span>ELEMS<span class="sh_symbol">;</span></li><li></li><li>    <span class="sh_comment">// Renormalise all values and compute cumulative sum</span></li><li>    <span class="sh_type">float</span> cum_sum<span class="sh_symbol">[</span>ELEMS<span class="sh_symbol">];</span></li><li>    cum_sum<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> starting_vec<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]/</span>k<span class="sh_symbol">;</span></li><li class="box box-top" style="margin-left: -3.3em;"><span class="box-sp" style="width: 21px;">&nbsp;</span>    <span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_usertype">size_t</span><span class="sh_normal"> </span>i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> ELEMS<span class="sh_symbol">;</span> i<span class="sh_symbol">++)</span></li><li class="box box-bot" style="margin-left: -3.3em;"><span class="box-sp" style="width: 21px;">&nbsp;</span>        cum_sum<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> starting_vec<span class="sh_symbol">[</span>i<span class="sh_symbol">]/</span>ELEMS <span class="sh_symbol">+</span> cum_sum<span class="sh_symbol">[</span>i<span class="sh_number">-1</span><span class="sh_symbol">];</span></li><li></li><li>    <span class="sh_comment">/* ... */</span></li><li><span class="sh_cbracket">}</span></li><li></li><li class="box box-top" style="margin-left: -3.3em;"><span class="box-sp" style="width: 21px;">&nbsp;</span><span class="sh_type">void</span> <span class="sh_function">mmult</span><span class="sh_symbol">(</span><span class="sh_type">float</span> <span class="sh_symbol">**</span>A<span class="sh_symbol">,</span> <span class="sh_type">float</span> <span class="sh_symbol">**</span>B<span class="sh_symbol">,</span> <span class="sh_type">float</span> <span class="sh_symbol">**</span>C<span class="sh_symbol">,</span> <span class="sh_usertype">size_t</span><span class="sh_normal"> </span>dim<span class="sh_symbol">)</span><span class="sh_cbracket">{</span></li><li class="box box-mid" style="margin-left: -3.3em;"><span class="box-sp" style="width: 21px;">&nbsp;</span>    <span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_usertype">size_t</span><span class="sh_normal"> </span>i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> i <span class="sh_symbol">&lt;</span> dim<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span></li><li class="box box-mid" style="margin-left: -3.3em;"><span class="box-sp" style="width: 21px;">&nbsp;</span>        <span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_usertype">size_t</span><span class="sh_normal"> </span>j <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> j <span class="sh_symbol">&lt;</span> dim<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span></li><li class="box box-mid" style="margin-left: -3.3em;"><span class="box-sp" style="width: 21px;">&nbsp;</span>            <span class="sh_keyword">for</span> <span class="sh_symbol">(</span><span class="sh_usertype">size_t</span><span class="sh_normal"> </span>k <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span> k <span class="sh_symbol">&lt;</span> dim<span class="sh_symbol">;</span> <span class="sh_symbol">++</span>i<span class="sh_symbol">)</span></li><li class="box box-mid" style="margin-left: -3.3em;"><span class="box-sp" style="width: 21px;">&nbsp;</span>                C<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">+=</span> A<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>k<span class="sh_symbol">]</span> <span class="sh_symbol">*</span> B<span class="sh_symbol">[</span>k<span class="sh_symbol">][</span>j<span class="sh_symbol">];</span></li><li class="box box-bot" style="margin-left: -3.3em;"><span class="box-sp" style="width: 21px;">&nbsp;</span><span class="sh_cbracket">}</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display: none;" tabindex="0" contenteditable="">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;time.h&gt;
#include &lt;math.h&gt;

void reshape2vec(float *out_vec, float *in_mat[], size_t dim){
    for (size_t i = 0; i &lt; dim; ++i)
        for (size_t j = 0; j &lt; dim; ++j)
            out_vec[i*dim + j] = in_mat[i][j];
}

int main()
{

    const size_t ELEMS = 1000*1000;
    float starting_vec[ELEMS];
    time_t t;
    
    srand((unsigned) time(&amp;t));
    random_fill(starting_vec, ELEMS);
    
    // Divide all points by 2 and add 4 for later stage
    for (size_t i = 0; i &lt; ELEMS; ++i){
        starting_vec[i] /= 2;
        starting_vec[i] += 4;
    }
    
    // Calculate mean
    float k = 0;
    for (size_t i = 0; i &lt; ELEMS; ++i)
        k += starting_vec[i]/ELEMS;

    // Renormalise all values and compute cumulative sum
    float cum_sum[ELEMS];
    cum_sum[0] = starting_vec[0]/k;
    for (size_t i = 1; i &lt; ELEMS; i++)
        cum_sum[i] = starting_vec[i]/ELEMS + cum_sum[i-1];

    /* ... */
}

void mmult(float **A, float **B, float **C, size_t dim){
    for (size_t i = 0; i &lt; dim; ++i)
        for (size_t j = 0; j &lt; dim; ++i)
            for (size_t k = 0; k &lt; dim; ++i)
                C[i][j] += A[i][k] * B[k][j];
}</pre></div></div>
<script src="shi_jquery.min.js"></script>
</body>
</html>